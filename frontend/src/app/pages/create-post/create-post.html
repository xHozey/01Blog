<app-navbar-component />

<div class="create-post-page">
  <!-- Header -->
  <header class="create-post-header">
    <div class="container">
      <div class="header-content">
        <div class="header-left">
          <button class="back-btn" (click)="handleCancel()">
            <lucide-icon [img]="ArrowLeftIcon" size="20"></lucide-icon>
          </button>
          <h1 class="page-title">Create a post</h1>
        </div>
        <button 
          class="publish-btn" 
          [disabled]="!content.trim()" 
          (click)="handleSubmit()">
          <lucide-icon [img]="SendIcon" size="16"></lucide-icon>
          Publish
        </button>
      </div>
    </div>
  </header>

  <!-- Main Editor Area -->
  <main class="editor-container">
    <!-- Title Input -->
    <input 
      type="text" 
      class="title-input" 
      placeholder="Title" 
      [(ngModel)]="title" 
      maxlength="300" />

    <!-- Content Editor -->
    <div class="editor-wrapper">
      @if (editor) {
        <div class="NgxEditor__Wrapper">
          <ngx-editor-menu [editor]="editor"></ngx-editor-menu>
          <ngx-editor 
            [editor]="editor" 
            [(ngModel)]="content" 
            [placeholder]="'Tell your story...'">
          </ngx-editor>
        </div>
      }
    </div>

    <!-- Media Section -->
    @if (previewUrl) {
      <!-- Media Preview -->
      <div class="media-preview">
        @if (isImage) {
          <img [src]="previewUrl" alt="Preview" />
        }
        @else if (isVideo) {
          <video [src]="previewUrl" controls></video>
        }
        <button class="remove-media-btn" (click)="removeFile()">
          <lucide-icon [img]="XIcon" size="18"></lucide-icon>
        </button>
      </div>
    } @else {
      <!-- Upload Area -->
      <div 
        class="upload-area" 
        [class.drag-over]="dragOver"
        (click)="fileInputRef.click()" 
        (dragover)="onDragOver($event)" 
        (dragleave)="onDragLeave()"
        (drop)="onDrop($event)">
        <div class="upload-icon-wrapper">
          <lucide-icon 
            [img]="dragOver ? UploadIcon : ImageIcon" 
            [size]="48" 
            class="upload-icon">
          </lucide-icon>
        </div>
        <p class="upload-title">
          {{ dragOver ? 'Drop your file here' : 'Add to your story' }}
        </p>
        <p class="upload-subtitle">
          Click to upload or drag and drop an image or video
        </p>
        <input 
          #fileInputRef 
          type="file" 
          accept="image/*,video/*" 
          (change)="onFileSelect($event)" 
          style="display: none;" />
      </div>
    }

    <!-- Character Counter -->
    @if (content.length > 0) {
      <div class="char-counter">
        <span 
          class="char-count" 
          [class.warning]="content.length > 9500">
          {{ content.length | number }} / 10,000
        </span>
      </div>
    }
  </main>
</div>